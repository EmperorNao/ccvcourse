### Gradients and edge detection

Edges are discontinuities in intensity \
It can be boundary of
- of object
- of material
- of lighting

#### Type of edges (1d)

Edges can be modeled according to their intensity profiles:
- step - big gradient for small time 
- ramp - not big gradient for long time

1. Ridge edge 
intensity changes its value but then returned back within short distance, probably generated by line.

2. Roof edge
Like ridge, but intensity changes not in one moment, but over time, probably generated by the intersection of surfaces

#### Edge descriptors
- Edge normal: unit vector in the direction of maximum intensity change.
- Edge direction: unit vector along edge (perpendicular to edge normal).
- Edge position or center: the image position at which the edge is located.
- Edge strength or magnitude: local image contrast along the normal.

#### Edge detector
Edge detector is always smoothing against localization\
We want thin, one-pixel wide, connected contours\

#### Canny edge detector
Most used classical algorithm\
Edge detection always involves 3 steps:
 - Noise smoothing
 - Edge enhancment
 - Edge localization

#### Edge model (1d)
Ideal edge is step: 0 if x < 0, A if x <= 0

#### Performance criteria
- Filter must have stronger response at the edge location (x = 0) than to noise
- Filter response must be maximum very close to x = 0
- There should be only on maximum in a neighborhoud of x = 0

#### Canny Edge Detector
- Canny found a linear, continuous filter that
maximized the three given criteria.
- There is no closed-form solution for the optimal filter.
- However, it looks VERY SIMILAR to the derivative
of a Gaussian

#### Thinning
do thinning before thresholding:
we can do this by looking for a maximum along a 1D intensity
slice normal to the curve.

#### Threshold
- If the threshold is too high:
    1. Very few (none) edges
    2. High MISDETECTIONS, many gaps
- If the threshold is too low:
    1. Too many (all pixels) edges
    2. High FALSE POSITIVES, many extra edges


#### SOLUTION: Hysteresis Thresholding
Allows us to apply both! (e.g. a “fuzzy” threshold)
 - Keep both a high threshold H and a low threshold L.
 - Any edges with strength < L are discarded.
 - Any edge with strength > H are kept.
 - An edge P with strength between L and H is kept
only if there is a path of edges with strength > L
connecting P to an edge of strength > H.
- In practice, this thresholding is combined with
edge linking to get connected contours

#### Canny detector:
1. Compute x and y derivatives of image\
    $I_x = G^x_{\sigma} \cdot I $\
    $I_y = G^y_{\sigma} \cdot I $
2. Compute Magnitude of gradient at every pixel\
    $M(x, y) = |\nabla I| = \sqrt(I^2_x + I^2_y)$
3. Elliminate those pixels that are not local maxima of the magnitude in the direction of the gradient
4. Hysteresis:
    - Select pixel such that $M > T_h$
    - Collect the pixels sush that $M > T_l$ that are neighbors of already collected edge points




